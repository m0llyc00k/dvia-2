{"changed":true,"filter":false,"title":"spiralRats.html","tooltip":"/Final/rats/spiralRats.html","value":"<!DOCTYPE html>\n<html>\n\t<head>\n\t\t<meta charset=\"utf-8\">\n\t\t<title>Nightingale's Rose</title>\n\t\t<!-- Stylesheets -->\n\t\t<link href=\"https://fonts.googleapis.com/css?family=Cabin:500\" rel='stylesheet' type='text/css'>\n\t\t<link rel=\"stylesheet\" type=\"text/css\" href=\"reset.css\">\n\t\t<link rel=\"stylesheet\" type=\"text/css\" href=\"style.css\">\n\t\t<!-- Libraries -->\n\t\t<script type=\"text/javascript\" src=\"d3.min.js\"></script>\n\t\t<!-- Scripts -->\n\t\t<script type=\"text/javascript\" src=\"script.js\"></script>\n\t</head>\n\t<body>\t\n\t\t<!--<h1>Nightingale's Rose</h1>-->\n\n\t\t<!-- Inspiration:\n\t\t\thttp://mbostock.github.io/protovis/ex/crimea-rose.html\n\t\t\thttp://understandinguncertainty.org/node/213\n\t\t-->\t\t\n\t\t\n\t\t<script type=\"text/javascript\">\n\t\t\tvar rose = Chart.rose(),\n\t\t\t\theight = 600,\n\t\t\t\tformat = d3.time.format('%m/%Y'),\n\t\t\t\tcauses = ['disease', 'wounds', 'other'],\n\t\t\t\tlabels = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\n\n\t\t\t// Add a title:\n\t\t\td3.select('body').append('h2')\n\t\t\t\t.attr('class', 'title')\n\t\t\t\t.html( 'Diagram <span class=\"small\">of the</span> Causes <span class=\"small\">of</span> Mortality <span class=\"small\">in the</span> Army <span class=\"small\">of the</span> East');\n\n\t\t\t// Add sub-titles:\n\t\t\td3.select('body').append('h3')\n\t\t\t\t.attr('class', 'subtitle left')\n\t\t\t\t.html('April 1855 - March 1856');\n\n\t\t\td3.select('body').append('h3')\n\t\t\t\t.attr('class', 'subtitle right')\n\t\t\t\t.html('April 1854 - March 1855');\n\n\t\t\t// Load the JSON data:\n\t\t\td3.json( 'data.json', function( data ) {\n\t\t\t\t// Data from: http://ocp.hul.harvard.edu/dl/contagion/010164675\n\n\t\t\t\t// Format the date and rework the data:\n\t\t\t\tvar scalar;\n\t\t\t\tdata.forEach( function(d) { \n\t\t\t\t\td.date = format.parse(d.date);\n\t\t\t\t\td.label = labels[d.date.getMonth()];\n\t\t\t\t\t\n\t\t\t\t\t// Calculate the average annual mortality, as done by Nightingale:\n\t\t\t\t\t// http://understandinguncertainty.org/node/214 \n\t\t\t\t\tscalar = 1000*12 / d.army_size;\n\t\t\t\t\td.disease = d.disease * scalar;\n\t\t\t\t\td.wounds  = d.wounds  * scalar;\n\t\t\t\t\td.other   = d.other   * scalar;\n\t\t\t\t} );\n\n\t\t\t\t// Get the maximum value:\n\t\t\t\tvar maxVal = d3.max( data, function(d) {\n\t\t\t\t\treturn d3.max( [d.disease, d.wounds, d.other] );\n\t\t\t\t});\n\n\t\t\t\t// Where the maximum value gives us the maximum radius:\n\t\t\t\tvar maxRadius = Math.sqrt(maxVal*12 / Math.PI);\n\n\t\t\t\t// Divide the dataset in two:\n\t\t\t\tvar dataset2 = data.slice(12,24),\n\t\t\t\t\tdataset1 = data.slice(0,12);\n\t\t\t\t\n\t\t\t\t// Append a new figure to the DOM:\n\t\t\t\tfigure = d3.select( 'body' )\n\t\t\t\t\t.append( 'figure' );\n\n\t\t\t\t// Get the figure width:\n\t\t\t\twidth = parseInt( figure.style( 'width' ), 10 );\n\n\t\t\t\t// Update the chart generator settings:\n\t\t\t\trose.legend( causes )\n\t\t\t\t\t.width( width )\n\t\t\t\t\t.height( height )\n\t\t\t\t\t.delay( 0 )\n\t\t\t\t\t.duration( 500 )\n\t\t\t\t\t.domain( [0, maxRadius] )\n\t\t\t\t\t.angle( function(d) { return d.date.getMonth(); } )\n\t\t\t\t\t.area( function(d, i) { return [d.disease, d.wounds, d.other]; } );\t\t\t\t\t\t\t\n\n\t\t\t\t// Bind the data and generate a new chart:\n\t\t\t\tfigure.datum( dataset1 )\n\t\t\t\t\t.attr('class', 'chart figure1')\n\t\t\t\t\t.call( rose );\t\n\n\t\t\t\t// Append a new figure to the DOM:\n\t\t\t\tfigure = d3.select( 'body' )\n\t\t\t\t\t.append( 'figure' );\n\n\t\t\t\t// Get the figure width:\n\t\t\t\twidth = parseInt( figure.style( 'width' ), 10 );\n\n\t\t\t\t// Update the chart generator settings:\n\t\t\t\trose.width( width )\n\t\t\t\t\t.delay( 3000 );\n\n\t\t\t\t// Bind the second dataset and generate a new chart:\n\t\t\t\tfigure.datum( dataset2 )\n\t\t\t\t\t.attr('class', 'chart figure2')\n\t\t\t\t\t.call( rose );\t\n\n\t\t\t\t// Append a caption:\n\t\t\t\td3.select('.figure2').append('figcaption')\n\t\t\t\t\t.attr('class', 'caption')\n\t\t\t\t\t.html('The Areas of the blue, red, &amp; black wedges are each measured from the centre as the common vertex <p> The blue wedges measured from the centre of the circle represent area for area the deaths from Preventible or Mitigable Zymotic Diseases, the red wedges measured from the center the deaths from wounds, &amp; the black wedges measured from the center the deaths from all other causes </p><p> In October 1844, &amp; April 1855, the black area coincides with the red, in January &amp; February 1856, the blue coincides with the black </p><p> The entire areas may be compared by following the blue, the red &amp; the black lines enclosing them.</p>');\n\n\t\t\t\t// Create a legend:\n\t\t\t\tChart.legend( causes );\n\n\t\t\t\t// Create a slider:\n\t\t\t\tChart.slider( 0, data.length, 1 ); // minVal, maxVal, step\n\t\t\t\t\n\t\t\t});\t\n\n\t\t</script>\n\t</body>\n</html>\n","undoManager":{"mark":-2,"position":1,"stack":[[{"start":{"row":0,"column":0},"end":{"row":877,"column":1},"action":"insert","lines":["<!DOCTYPE html>","<html>","\t<head>","\t\t<meta charset=\"utf-8\">","\t\t<title>Nightingale's Rose</title>","\t\t<!-- Stylesheets -->","\t\t<link href=\"https://fonts.googleapis.com/css?family=Cabin:500\" rel='stylesheet' type='text/css'>","\t\t<link rel=\"stylesheet\" type=\"text/css\" href=\"reset.css\">","\t\t<link rel=\"stylesheet\" type=\"text/css\" href=\"style.css\">","\t\t<!-- Libraries -->","\t\t<script type=\"text/javascript\" src=\"d3.min.js\"></script>","\t\t<!-- Scripts -->","\t\t<script type=\"text/javascript\" src=\"script.js\"></script>","\t</head>","\t<body>\t","\t\t<!--<h1>Nightingale's Rose</h1>-->","","\t\t<!-- Inspiration:","\t\t\thttp://mbostock.github.io/protovis/ex/crimea-rose.html","\t\t\thttp://understandinguncertainty.org/node/213","\t\t-->\t\t","\t\t","\t\t<script type=\"text/javascript\">","\t\t\tvar rose = Chart.rose(),","\t\t\t\theight = 600,","\t\t\t\tformat = d3.time.format('%m/%Y'),","\t\t\t\tcauses = ['disease', 'wounds', 'other'],","\t\t\t\tlabels = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];","","\t\t\t// Add a title:","\t\t\td3.select('body').append('h2')","\t\t\t\t.attr('class', 'title')","\t\t\t\t.html( 'Diagram <span class=\"small\">of the</span> Causes <span class=\"small\">of</span> Mortality <span class=\"small\">in the</span> Army <span class=\"small\">of the</span> East');","","\t\t\t// Add sub-titles:","\t\t\td3.select('body').append('h3')","\t\t\t\t.attr('class', 'subtitle left')","\t\t\t\t.html('April 1855 - March 1856');","","\t\t\td3.select('body').append('h3')","\t\t\t\t.attr('class', 'subtitle right')","\t\t\t\t.html('April 1854 - March 1855');","","\t\t\t// Load the JSON data:","\t\t\td3.json( 'data.json', function( data ) {","\t\t\t\t// Data from: http://ocp.hul.harvard.edu/dl/contagion/010164675","","\t\t\t\t// Format the date and rework the data:","\t\t\t\tvar scalar;","\t\t\t\tdata.forEach( function(d) { ","\t\t\t\t\td.date = format.parse(d.date);","\t\t\t\t\td.label = labels[d.date.getMonth()];","\t\t\t\t\t","\t\t\t\t\t// Calculate the average annual mortality, as done by Nightingale:","\t\t\t\t\t// http://understandinguncertainty.org/node/214 ","\t\t\t\t\tscalar = 1000*12 / d.army_size;","\t\t\t\t\td.disease = d.disease * scalar;","\t\t\t\t\td.wounds  = d.wounds  * scalar;","\t\t\t\t\td.other   = d.other   * scalar;","\t\t\t\t} );","","\t\t\t\t// Get the maximum value:","\t\t\t\tvar maxVal = d3.max( data, function(d) {","\t\t\t\t\treturn d3.max( [d.disease, d.wounds, d.other] );","\t\t\t\t});","","\t\t\t\t// Where the maximum value gives us the maximum radius:","\t\t\t\tvar maxRadius = Math.sqrt(maxVal*12 / Math.PI);","","\t\t\t\t// Divide the dataset in two:","\t\t\t\tvar dataset2 = data.slice(12,24),","\t\t\t\t\tdataset1 = data.slice(0,12);","\t\t\t\t","\t\t\t\t// Append a new figure to the DOM:","\t\t\t\tfigure = d3.select( 'body' )","\t\t\t\t\t.append( 'figure' );","","\t\t\t\t// Get the figure width:","\t\t\t\twidth = parseInt( figure.style( 'width' ), 10 );","","\t\t\t\t// Update the chart generator settings:","\t\t\t\trose.legend( causes )","\t\t\t\t\t.width( width )","\t\t\t\t\t.height( height )","\t\t\t\t\t.delay( 0 )","\t\t\t\t\t.duration( 500 )","\t\t\t\t\t.domain( [0, maxRadius] )","\t\t\t\t\t.angle( function(d) { return d.date.getMonth(); } )","\t\t\t\t\t.area( function(d, i) { return [d.disease, d.wounds, d.other]; } );\t\t\t\t\t\t\t","","\t\t\t\t// Bind the data and generate a new chart:","\t\t\t\tfigure.datum( dataset1 )","\t\t\t\t\t.attr('class', 'chart figure1')","\t\t\t\t\t.call( rose );\t","","\t\t\t\t// Append a new figure to the DOM:","\t\t\t\tfigure = d3.select( 'body' )","\t\t\t\t\t.append( 'figure' );","","\t\t\t\t// Get the figure width:","\t\t\t\twidth = parseInt( figure.style( 'width' ), 10 );","","\t\t\t\t// Update the chart generator settings:","\t\t\t\trose.width( width )","\t\t\t\t\t.delay( 3000 );","","\t\t\t\t// Bind the second dataset and generate a new chart:","\t\t\t\tfigure.datum( dataset2 )","\t\t\t\t\t.attr('class', 'chart figure2')","\t\t\t\t\t.call( rose );\t","","\t\t\t\t// Append a caption:","\t\t\t\td3.select('.figure2').append('figcaption')","\t\t\t\t\t.attr('class', 'caption')","\t\t\t\t\t.html('The Areas of the blue, red, &amp; black wedges are each measured from the centre as the common vertex <p> The blue wedges measured from the centre of the circle represent area for area the deaths from Preventible or Mitigable Zymotic Diseases, the red wedges measured from the center the deaths from wounds, &amp; the black wedges measured from the center the deaths from all other causes </p><p> In October 1844, &amp; April 1855, the black area coincides with the red, in January &amp; February 1856, the blue coincides with the black </p><p> The entire areas may be compared by following the blue, the red &amp; the black lines enclosing them.</p>');","","\t\t\t\t// Create a legend:","\t\t\t\tChart.legend( causes );","","\t\t\t\t// Create a slider:","\t\t\t\tChart.slider( 0, data.length, 1 ); // minVal, maxVal, step","\t\t\t\t","\t\t\t});\t","","\t\t</script>","\t</body>","</html>","data.json#","[","  {","  \t\"date\": \"4/1854\",","  \t\"army_size\": 8571, ","  \t\"disease\": 1, ","  \t\"wounds\": 0, ","  \t\"other\": 5 ","  },","  {","  \t\"date\": \"5/1854\", ","  \t\"army_size\": 23333, ","  \t\"disease\": 12, ","  \t\"wounds\": 0, ","  \t\"other\": 9 ","  },","  {","  \t\"date\": \"6/1854\", ","  \t\"army_size\": 28333, ","  \t\"disease\": 11, ","  \t\"wounds\": 0, ","  \t\"other\": 6 ","  },","  {","  \t\"date\": \"7/1854\", ","  \t\"army_size\": 28722, ","  \t\"disease\": 359, ","  \t\"wounds\": 0, ","  \t\"other\": 23 ","  },","  {","  \t\"date\": \"8/1854\", ","  \t\"army_size\": 30246, ","  \t\"disease\": 828, ","  \t\"wounds\": 1, ","  \t\"other\": 30 ","  },","  {","  \t\"date\": \"9/1854\", ","  \t\"army_size\": 30290, ","  \t\"disease\": 788, ","  \t\"wounds\": 81, ","  \t\"other\": 70 ","  },","  {","  \t\"date\": \"10/1854\", ","  \t\"army_size\": 30643, ","  \t\"disease\": 503, ","  \t\"wounds\": 132, ","  \t\"other\": 128 ","  },","  {","  \t\"date\": \"11/1854\", ","  \t\"army_size\": 29736, ","  \t\"disease\": 844, ","  \t\"wounds\": 287, ","  \t\"other\": 106 ","  },","  {","  \t\"date\": \"12/1854\", ","  \t\"army_size\": 32779, ","  \t\"disease\": 1725, ","  \t\"wounds\": 114, ","  \t\"other\": 131 ","  },","  {","  \t\"date\": \"1/1855\", ","  \t\"army_size\": 32393, ","  \t\"disease\": 2761, ","  \t\"wounds\": 83, ","  \t\"other\": 324 ","  },","  {","  \t\"date\": \"2/1855\", ","  \t\"army_size\": 30919, ","  \t\"disease\": 2120, ","  \t\"wounds\": 42, ","  \t\"other\": 361 ","  },","  {","  \t\"date\": \"3/1855\", ","  \t\"army_size\": 30107, ","  \t\"disease\": 1205, ","  \t\"wounds\": 32, ","  \t\"other\": 172 ","  },","  {","  \t\"date\": \"4/1855\", ","  \t\"army_size\": 32252, ","  \t\"disease\": 477, ","  \t\"wounds\": 48, ","  \t\"other\": 57 ","  },","  {","  \t\"date\": \"5/1855\", ","  \t\"army_size\": 35473, ","  \t\"disease\": 508, ","  \t\"wounds\": 49, ","  \t\"other\": 37 ","  },","  {","  \t\"date\": \"6/1855\", ","  \t\"army_size\": 38863, ","  \t\"disease\": 802, ","  \t\"wounds\": 209, ","  \t\"other\": 31 ","  },","  {","  \t\"date\": \"7/1855\", ","  \t\"army_size\": 42647, ","  \t\"disease\": 382, ","  \t\"wounds\": 134, ","  \t\"other\": 33 ","  },","  {","  \t\"date\": \"8/1855\", ","  \t\"army_size\": 44614, ","  \t\"disease\": 483, ","  \t\"wounds\": 164, ","  \t\"other\": 25 ","  },","  {","  \t\"date\": \"9/1855\", ","  \t\"army_size\": 47751, ","  \t\"disease\": 189, ","  \t\"wounds\": 276, ","  \t\"other\": 20 ","  },","  {","  \t\"date\": \"10/1855\", ","  \t\"army_size\": 46852, ","  \t\"disease\": 128, ","  \t\"wounds\": 53, ","  \t\"other\": 18 ","  },","  {","  \t\"date\": \"11/1855\", ","  \t\"army_size\": 37853, ","  \t\"disease\": 178, ","  \t\"wounds\": 33, ","  \t\"other\": 32 ","  },","  {","  \t\"date\": \"12/1855\", ","  \t\"army_size\": 43217, ","  \t\"disease\": 91, ","  \t\"wounds\": 18, ","  \t\"other\": 28 ","  },","  {","  \t\"date\": \"1/1856\", ","  \t\"army_size\": 44212, ","  \t\"disease\": 42, ","  \t\"wounds\": 2, ","  \t\"other\": 48 ","  },","  {","  \t\"date\": \"2/1856\", ","  \t\"army_size\": 43485, ","  \t\"disease\": 24, ","  \t\"wounds\": 0, ","  \t\"other\": 19 ","  },","  {","  \t\"date\": \"3/1856\", ","  \t\"army_size\": 46140, ","  \t\"disease\": 15, ","  \t\"wounds\": 0, ","  \t\"other\": 35 ","  }","]","reset.css#","/* http://meyerweb.com/eric/tools/css/reset/ ","   v2.0 | 20110126","   License: none (public domain)","*/","","html, body, div, span, applet, object, iframe,","h1, h2, h3, h4, h5, h6, p, blockquote, pre,","a, abbr, acronym, address, big, cite, code,","del, dfn, em, img, ins, kbd, q, s, samp,","small, strike, strong, sub, sup, tt, var,","b, u, i, center,","dl, dt, dd, ol, ul, li,","fieldset, form, label, legend,","table, caption, tbody, tfoot, thead, tr, th, td,","article, aside, canvas, details, embed, ","figure, figcaption, footer, header, hgroup, ","menu, nav, output, ruby, section, summary,","time, mark, audio, video {","\tmargin: 0;","\tpadding: 0;","\tborder: 0;","\tfont-size: 100%;","\tfont: inherit;","\tvertical-align: baseline;","}","/* HTML5 display-role reset for older browsers */","article, aside, details, figcaption, figure, ","footer, header, hgroup, menu, nav, section {","\tdisplay: block;","}","body {","\tline-height: 1;","}","ol, ul {","\tlist-style: none;","}","blockquote, q {","\tquotes: none;","}","blockquote:before, blockquote:after,","q:before, q:after {","\tcontent: '';","\tcontent: none;","}","table {","\tborder-collapse: collapse;","\tborder-spacing: 0;","}","script.js#","/**","*","*","*","*\tNOTES:","*\t\t[1] Slider could be improved. No displayed limits. Values are hidden. Etc.","*\t\t[2] This chart's API is restricted and makes assumptions. E.g., legend entries provided to 'rose' and 'legend' are the same.","*","*","*","*\t@author Kristofer Gryte. http://www.kgryte.com","*","*","*/","","","","","var Chart = {};","","Chart.rose = function() {","","\tvar margin = {'top': 20, 'right': 20, 'bottom': 20, 'left': 20},","\t\theight = 500,","\t\twidth = 500,","\t\tcolor = 'rgb(0,0,0)',","\t\tarea = function(d) { return [d.y]; },","\t\tangle = function(d) { return d.x; },","\t\tradiusScale = d3.scale.linear(),","\t\tangleScale = d3.scale.linear().range( [Math.PI, 3*Math.PI ] ),","\t\tdomain = [0, 1],","\t\tlegend = [''],","\t\tlabel = function(d) { return d.label; },","\t\tdelay = 1000,","\t\tduration = 100,","\t\tcanvas, graph, centerX, centerY, numWedges, wedgeGroups, wedges, legendGroup;","","\t// Arc Generator:","\tvar arc = d3.svg.arc()","\t\t.innerRadius( 0 )","\t\t.outerRadius( function(d,i) { return radiusScale( d.radius ); } )","\t\t.startAngle( function(d,i) { return angleScale( d.angle ); } );","","\tfunction chart( selection ) {","","\t\tselection.each( function( data ) {","","\t\t\t// Determine the number of wedges:","\t\t\tnumWedges = data.length;","","\t\t\t// Standardize the data:","\t\t\tdata = formatData( data );","","\t\t\t// Update the chart parameters:","\t\t\tupdateParams();","","\t\t\t// Create the chart base:","\t\t\tcreateBase( this );","","\t\t\t// Create the wedges:","\t\t\tcreateWedges( data );","","\t\t});","","\t}; // end FUNCTION chart()","","\t//","\tfunction formatData( data ) {","\t\t// Convert data to standard representation; needed for non-deterministic accessors:","\t\tdata = data.map( function(d, i) {","\t\t\treturn {","\t\t\t\t'angle': angle.call(data, d, i),","\t\t\t\t'area': area.call(data, d, i),","\t\t\t\t'label': label.call(data, d, i)\t\t\t","\t\t\t};","\t\t});","","\t\t// Now convert the area values to radii:","\t\t// http://understandinguncertainty.org/node/214 ","\t\treturn data.map( function(d, i) {","\t\t\treturn {","\t\t\t\t'angle': d.angle,","\t\t\t\t'label': d.label,","\t\t\t\t'radius': d.area.map( function(area) {","\t\t\t\t\treturn Math.sqrt( area*numWedges / Math.PI );","\t\t\t\t})","\t\t\t}","\t\t})","\t}; // end FUNCTION formatData()","","\t//","\tfunction updateParams() {","\t\t// Update the arc generator:","\t\tarc.endAngle( function(d,i) { return angleScale( d.angle ) + (Math.PI / (numWedges/2)); } );","","\t\t// Determine the chart center:","\t\tcenterX = (width - margin.left - margin.right) / 2;","\t\tcenterY = (height - margin.top - margin.bottom) / 2;","","\t\t// Update the radius scale:","\t\tradiusScale.domain( domain )","\t\t\t.range( [0, d3.min( [centerX, centerY] ) ] );","","\t\t// Update the angle scale:","\t\tangleScale.domain( [0, numWedges] );\t\t","\t}; // end FUNCTION updateParams()","","\t// ","\tfunction createBase( selection ) {","","\t\t// Create the SVG element:","\t\tcanvas = d3.select( selection ).append('svg:svg')","\t\t\t.attr('width', width)","\t\t\t.attr('height', height)","\t\t\t.attr('class', 'canvas');","","\t\t// Create the graph element:","\t\tgraph = canvas.append('svg:g')","\t\t\t.attr('class', 'graph')","\t\t\t.attr('transform', 'translate(' + (centerX + margin.left) + ',' + (centerY + margin.top) + ')');","","\t}; // end FUNCTION createBase()","","","\tfunction createWedges( data ) {","","\t\t// Create the wedge groups:","\t\twedgeGroups = graph.selectAll('.wedgeGroup')","\t\t\t.data( data )","\t\t  .enter().append('svg:g')","\t\t  \t.attr('class', 'wedgeGroup')","\t\t  \t.attr('transform', 'scale(0,0)');","","\t\t// Create the wedges:","\t\twedges = wedgeGroups.selectAll('.wedge')","\t\t  \t.data( function(d) { ","\t\t  \t\tvar ids = d3.range(0, legend.length);","","\t\t  \t\tids.sort( function(a,b) { ","\t\t\t  \t\tvar val2 = d.radius[b],","\t\t\t  \t\t\tval1 = d.radius[a]","\t\t\t  \t\treturn  val2 - val1; ","\t\t\t  \t});","\t\t\t  \treturn ids.map( function(i) {","\t\t\t  \t\treturn {","\t\t\t  \t\t\t'legend': legend[i],","\t\t\t  \t\t\t'radius': d.radius[i],","\t\t\t  \t\t\t'angle': d.angle","\t\t\t  \t\t};","\t\t\t  \t});","\t\t  \t})","\t\t  .enter().append('svg:path')","\t\t  \t.attr('class', function(d) { return 'wedge ' + d.legend; })","\t\t  \t.attr('d', arc );","","\t\t// Append title tooltips:","\t\twedges.append('svg:title')","\t\t\t.text( function(d) { return d.legend + ': ' + Math.floor(Math.pow(d.radius,2) * Math.PI / numWedges); });","","\t\t// Transition the wedges to view:","\t\twedgeGroups.transition()","\t\t\t.delay( delay )","\t\t\t.duration( function(d,i) { ","\t\t\t\treturn duration*i;","\t\t\t})","\t\t\t.attr('transform', 'scale(1,1)');","","\t\t// Append labels to the wedgeGroups:","\t\tvar numLabels = d3.selectAll('.label-path')[0].length;","\t\t","\t\twedgeGroups.selectAll('.label-path')","\t\t\t.data( function(d,i) { ","\t\t\t\treturn [","\t\t\t\t\t{","\t\t\t\t\t\t'index': i,","\t\t\t\t\t\t'angle': d.angle,","\t\t\t\t\t\t'radius': d3.max( d.radius.concat( [23] ) )","\t\t\t\t\t}","\t\t\t\t];","\t\t\t} )","\t\t  .enter().append('svg:path')","\t\t  \t.attr('class', 'label-path')","\t\t  \t.attr('id', function(d) {","\t\t  \t\treturn 'label-path' + (d.index + numLabels);","\t\t  \t})","\t\t\t.attr('d', arc)","\t\t  \t.attr('fill', 'none')","\t\t  \t.attr('stroke', 'none');","","\t\twedgeGroups.selectAll('.label')","\t\t\t.data( function(d,i) { ","\t\t\t\treturn [","\t\t\t\t\t{","\t\t\t\t\t\t'index': i,","\t\t\t\t\t\t'label': d.label","\t\t\t\t\t}","\t\t\t\t];","\t\t\t} )","\t\t  .enter().append('svg:text')","\t   \t\t.attr('class', 'label')","\t   \t\t.attr('text-anchor', 'start')","\t   \t\t.attr('x', 5)","\t   \t\t.attr('dy', '-.71em')","\t   \t\t.attr('text-align', 'center')","\t  \t\t.append('textPath')","\t  \t\t\t.attr('xlink:href', function(d,i) { ","\t  \t\t\t\treturn '#label-path' + (d.index + numLabels);","\t  \t\t\t})","\t  \t\t\t.text( function(d) { return d.label; } );","","\t}; // end FUNCTION createWedges()\t","","\t// Set/Get: margin","\tchart.margin = function( _ ) {","\t\tif (!arguments.length) return margin;","\t\tmargin = _;","\t\treturn chart;","\t};","","\t// Set/Get: width","\tchart.width = function( _ ) {","\t\tif (!arguments.length) return width;","\t\twidth = _;","\t\treturn chart;","\t};","","\t// Set/Get: height","\tchart.height = function( _ ) {","\t\tif (!arguments.length) return height;","\t\theight = _;","\t\treturn chart;","\t};","","\t// Set/Get: area","\tchart.area = function( _ ) {","\t\tif (!arguments.length) return area;","\t\tarea = _;","\t\treturn chart;","\t};","","\t// Set/Get: angle","\tchart.angle = function( _ ) {","\t\tif (!arguments.length) return angle;","\t\tangle = _;","\t\treturn chart;","\t};","","\t// Set/Get: label","\tchart.label = function( _ ) {","\t\tif (!arguments.length) return label;","\t\tlabel = _;","\t\treturn chart;","\t};","","\t// Set/Get: domain","\tchart.domain = function( _ ) {","\t\tif (!arguments.length) return domain;","\t\tdomain = _;","\t\treturn chart;","\t};","","\t// Set/Get: legend","\tchart.legend = function( _ ) {","\t\tif (!arguments.length) return legend;","\t\tlegend = _;","\t\treturn chart;","\t};","","\t// Set/Get: delay","\tchart.delay = function( _ ) {","\t\tif (!arguments.length) return delay;","\t\tdelay = _;","\t\treturn chart;","\t};","","\t// Set/Get: duration","\tchart.duration = function( _ ) {","\t\tif (!arguments.length) return duration;","\t\tduration = _;","\t\treturn chart;","\t};","","\treturn chart;","","}; // end FUNCTION rose()","","","","","","Chart.legend = function( entries ) {","\t// NOTE: positioning handled by CSS.","","\t// Add a legend:","\tvar legend = {}, ","\t\theight,","\t\tsymbolRadius = 5;","","\tlegend.container = d3.select('body').append('div')","\t\t.attr('class', 'legend');","","\theight = parseInt( d3.select('.legend').style('height'), 10);","\tlegend.canvas = legend.container.append('svg:svg')","\t\t\t.attr('class', 'legend-canvas');","","\tlegend.entries = legend.canvas.selectAll('.legend-entry')","\t\t.data( entries )","\t  .enter().append('svg:g')","\t  \t.attr('class', 'legend-entry')","\t  \t.attr('transform', function(d,i) { return 'translate('+ (symbolRadius + i*120) +', ' + (height/2) + ')'; });","","\t// Append circles to each entry with appropriate class:","\tlegend.entries.append('svg:circle')","\t\t.attr('class', function(d) { return 'legend-symbol ' + d;} )","\t\t.attr('r', symbolRadius )","\t\t.attr('cy', 0 )","\t\t.attr('cx', 0 );","","\t// Append text to each entry:","\tlegend.entries.append('svg:text')","\t\t.attr('class', 'legend-text' )","\t\t.attr('text-anchor', 'start')","\t\t.attr('dy', '.35em')","\t\t.attr('transform', 'translate(' + (symbolRadius*2) + ',0)')","\t\t.text( function(d) { return d; } );","","\t// Add interactivity:","\tlegend.entries.on('mouseover.focus', mouseover)","\t\t.on('mouseout.focus', mouseout);","","\t//","\tfunction mouseover() {","","\t\t// Select the current element and get the symbol child class:","\t\tvar _class = d3.select( this ).select('.legend-symbol')","\t\t\t.attr('class')","\t\t\t.replace('legend-symbol ', ''); // left with legend class.","","\t\td3.selectAll('.wedge')","\t\t\t.filter( function(d,i) {","\t\t\t\t// Select those elements not belonging to the same symbol class:","\t\t\t\treturn !d3.select( this ).classed( _class );","\t\t\t})","\t\t\t.transition()","\t\t\t\t.duration( 1000 )","\t\t\t\t.attr('opacity', 0.05 );","","\t}; // end FUNCTION mouseover()","","\tfunction mouseout() {","","\t\td3.selectAll('.wedge')","\t\t\t.transition()","\t\t\t\t.duration( 500 )","\t\t\t\t.attr('opacity', 1 );","","\t}; // end FUNCTION mouseout()","","}; // end FUNCTION legend()","","","Chart.slider = function( minVal, maxVal, step ) {","","\td3.select('body').append('input')","\t\t.attr('class', 'slider')","\t\t.attr('type', 'range')","\t\t.attr('name', 'slider')","\t\t.attr('min', minVal)","\t\t.attr('max', maxVal)","\t\t.attr('step', 0.001)","\t\t.attr('value', maxVal);","","\td3.select(\"input\").on(\"change\", function() {","\t  var value = Math.round(this.value);","","\t  d3.selectAll('.wedgeGroup')","\t  \t.filter( function(d,i) { return i < value; } )","\t  \t.transition()","\t  \t\t.duration( 500 )","\t  \t\t.attr( 'transform', 'scale(1,1)');","\t  ","\t  d3.selectAll('.wedgeGroup')","\t  \t.filter( function(d,i) { return i >= value; } )","\t  \t.transition()","\t  \t\t.duration( 500 )","\t  \t\t.attr( 'transform', 'scale(0,0)' );","","\t});","","","}; // end FUNCTION slider()","","","style.css#","","","/* Apply a natural box layout model to all elements */","* { ","\t-moz-box-sizing: border-box;","\t-webkit-box-sizing: border-box;","\tbox-sizing: border-box; ","}","","body {","\tfont-family: 'Cabin', sans-serif;","\tfont-size: 14px;","\tfont-weight: normal;","\tcolor: #474747;","\twidth: 100%;","\tmin-height: 100%;","}","","figure {","\tposition: relative;","\tfloat: right;","\twidth: 50%;","\tmin-width: 400px;","\tmargin-top: -120px;","}","","h1 {","\twidth: 70%;","\tmargin: 0 auto;","\tmargin-top: 20px;","\tmargin-bottom: 20px;","\ttext-align: center;","\tfont-size: 24px;","}","",".title, .subtitle, .caption, .label, .legend, figure {","\tfont-family: baskerville, serif;","}","",".title, .subtitle, .label, .legend {","\ttext-transform: uppercase;","}","",".title {","\tfont-size: 18px;","\twidth: 400px;","\ttext-align: center;","\tdisplay: block;","\tmargin: 0 auto;","\tmargin-top: 50px;","}","","\t.title .small {","\t\tfont-size: 12px;","\t}","",".subtitle {","\tfont-size: 16px;","\twidth: 50%;","\tmin-width: 400px;","\tmargin-top: 16px;","\ttext-align: center;","}","","\t.subtitle.left {","\t\tfloat: left;","\t}","","\t.subtitle.right {","\t\tfloat: right;","\t}","","",".caption {","\tposition: relative;","\ttop: -170px;","\twidth: 320px;","\tdisplay: block;","\tmargin: 0 auto;","\tfont-style: oblique;","\tfont-size: 12px;","}","","\t.caption p {","\t\tmargin: 0;","\t\ttext-indent: 12px;","\t}","",".canvas {","\tfont-family: 'Cabin', sans-serif;"," \tfont-size: 14px;"," \tfill: #474747;"," \tfont-weight: normal;","}","",".wedge {","\tstroke: #aaa;","\tstroke-width: 1px;","\t/*shape-rendering: crispEdges;*/","}","",".label {","\tfont-size: 8px;","}","",".disease {","\tfill: rgb(198, 226, 255);","}","",".other {","\tfill: rgb(50,50,50);","}","",".wounds {","\tfill: rgb(252,112,147);","}","",".legend {","\twidth: 400px;","\theight: 50px;","\tpadding: 0 20px;","\tdisplay: block;","\tposition: relative;","\tmargin: 0 auto;","\ttop: -150px;","\ttext-align: center;","}","",".slider {","\twidth: 400px;","\tdisplay: block;","\tposition: relative;","\tmargin: 0 auto;","\tleft: -30px; /* hacky */","\ttop: -100px;","}"],"id":1}],[{"start":{"row":127,"column":0},"end":{"row":877,"column":1},"action":"remove","lines":["data.json#","[","  {","  \t\"date\": \"4/1854\",","  \t\"army_size\": 8571, ","  \t\"disease\": 1, ","  \t\"wounds\": 0, ","  \t\"other\": 5 ","  },","  {","  \t\"date\": \"5/1854\", ","  \t\"army_size\": 23333, ","  \t\"disease\": 12, ","  \t\"wounds\": 0, ","  \t\"other\": 9 ","  },","  {","  \t\"date\": \"6/1854\", ","  \t\"army_size\": 28333, ","  \t\"disease\": 11, ","  \t\"wounds\": 0, ","  \t\"other\": 6 ","  },","  {","  \t\"date\": \"7/1854\", ","  \t\"army_size\": 28722, ","  \t\"disease\": 359, ","  \t\"wounds\": 0, ","  \t\"other\": 23 ","  },","  {","  \t\"date\": \"8/1854\", ","  \t\"army_size\": 30246, ","  \t\"disease\": 828, ","  \t\"wounds\": 1, ","  \t\"other\": 30 ","  },","  {","  \t\"date\": \"9/1854\", ","  \t\"army_size\": 30290, ","  \t\"disease\": 788, ","  \t\"wounds\": 81, ","  \t\"other\": 70 ","  },","  {","  \t\"date\": \"10/1854\", ","  \t\"army_size\": 30643, ","  \t\"disease\": 503, ","  \t\"wounds\": 132, ","  \t\"other\": 128 ","  },","  {","  \t\"date\": \"11/1854\", ","  \t\"army_size\": 29736, ","  \t\"disease\": 844, ","  \t\"wounds\": 287, ","  \t\"other\": 106 ","  },","  {","  \t\"date\": \"12/1854\", ","  \t\"army_size\": 32779, ","  \t\"disease\": 1725, ","  \t\"wounds\": 114, ","  \t\"other\": 131 ","  },","  {","  \t\"date\": \"1/1855\", ","  \t\"army_size\": 32393, ","  \t\"disease\": 2761, ","  \t\"wounds\": 83, ","  \t\"other\": 324 ","  },","  {","  \t\"date\": \"2/1855\", ","  \t\"army_size\": 30919, ","  \t\"disease\": 2120, ","  \t\"wounds\": 42, ","  \t\"other\": 361 ","  },","  {","  \t\"date\": \"3/1855\", ","  \t\"army_size\": 30107, ","  \t\"disease\": 1205, ","  \t\"wounds\": 32, ","  \t\"other\": 172 ","  },","  {","  \t\"date\": \"4/1855\", ","  \t\"army_size\": 32252, ","  \t\"disease\": 477, ","  \t\"wounds\": 48, ","  \t\"other\": 57 ","  },","  {","  \t\"date\": \"5/1855\", ","  \t\"army_size\": 35473, ","  \t\"disease\": 508, ","  \t\"wounds\": 49, ","  \t\"other\": 37 ","  },","  {","  \t\"date\": \"6/1855\", ","  \t\"army_size\": 38863, ","  \t\"disease\": 802, ","  \t\"wounds\": 209, ","  \t\"other\": 31 ","  },","  {","  \t\"date\": \"7/1855\", ","  \t\"army_size\": 42647, ","  \t\"disease\": 382, ","  \t\"wounds\": 134, ","  \t\"other\": 33 ","  },","  {","  \t\"date\": \"8/1855\", ","  \t\"army_size\": 44614, ","  \t\"disease\": 483, ","  \t\"wounds\": 164, ","  \t\"other\": 25 ","  },","  {","  \t\"date\": \"9/1855\", ","  \t\"army_size\": 47751, ","  \t\"disease\": 189, ","  \t\"wounds\": 276, ","  \t\"other\": 20 ","  },","  {","  \t\"date\": \"10/1855\", ","  \t\"army_size\": 46852, ","  \t\"disease\": 128, ","  \t\"wounds\": 53, ","  \t\"other\": 18 ","  },","  {","  \t\"date\": \"11/1855\", ","  \t\"army_size\": 37853, ","  \t\"disease\": 178, ","  \t\"wounds\": 33, ","  \t\"other\": 32 ","  },","  {","  \t\"date\": \"12/1855\", ","  \t\"army_size\": 43217, ","  \t\"disease\": 91, ","  \t\"wounds\": 18, ","  \t\"other\": 28 ","  },","  {","  \t\"date\": \"1/1856\", ","  \t\"army_size\": 44212, ","  \t\"disease\": 42, ","  \t\"wounds\": 2, ","  \t\"other\": 48 ","  },","  {","  \t\"date\": \"2/1856\", ","  \t\"army_size\": 43485, ","  \t\"disease\": 24, ","  \t\"wounds\": 0, ","  \t\"other\": 19 ","  },","  {","  \t\"date\": \"3/1856\", ","  \t\"army_size\": 46140, ","  \t\"disease\": 15, ","  \t\"wounds\": 0, ","  \t\"other\": 35 ","  }","]","reset.css#","/* http://meyerweb.com/eric/tools/css/reset/ ","   v2.0 | 20110126","   License: none (public domain)","*/","","html, body, div, span, applet, object, iframe,","h1, h2, h3, h4, h5, h6, p, blockquote, pre,","a, abbr, acronym, address, big, cite, code,","del, dfn, em, img, ins, kbd, q, s, samp,","small, strike, strong, sub, sup, tt, var,","b, u, i, center,","dl, dt, dd, ol, ul, li,","fieldset, form, label, legend,","table, caption, tbody, tfoot, thead, tr, th, td,","article, aside, canvas, details, embed, ","figure, figcaption, footer, header, hgroup, ","menu, nav, output, ruby, section, summary,","time, mark, audio, video {","\tmargin: 0;","\tpadding: 0;","\tborder: 0;","\tfont-size: 100%;","\tfont: inherit;","\tvertical-align: baseline;","}","/* HTML5 display-role reset for older browsers */","article, aside, details, figcaption, figure, ","footer, header, hgroup, menu, nav, section {","\tdisplay: block;","}","body {","\tline-height: 1;","}","ol, ul {","\tlist-style: none;","}","blockquote, q {","\tquotes: none;","}","blockquote:before, blockquote:after,","q:before, q:after {","\tcontent: '';","\tcontent: none;","}","table {","\tborder-collapse: collapse;","\tborder-spacing: 0;","}","script.js#","/**","*","*","*","*\tNOTES:","*\t\t[1] Slider could be improved. No displayed limits. Values are hidden. Etc.","*\t\t[2] This chart's API is restricted and makes assumptions. E.g., legend entries provided to 'rose' and 'legend' are the same.","*","*","*","*\t@author Kristofer Gryte. http://www.kgryte.com","*","*","*/","","","","","var Chart = {};","","Chart.rose = function() {","","\tvar margin = {'top': 20, 'right': 20, 'bottom': 20, 'left': 20},","\t\theight = 500,","\t\twidth = 500,","\t\tcolor = 'rgb(0,0,0)',","\t\tarea = function(d) { return [d.y]; },","\t\tangle = function(d) { return d.x; },","\t\tradiusScale = d3.scale.linear(),","\t\tangleScale = d3.scale.linear().range( [Math.PI, 3*Math.PI ] ),","\t\tdomain = [0, 1],","\t\tlegend = [''],","\t\tlabel = function(d) { return d.label; },","\t\tdelay = 1000,","\t\tduration = 100,","\t\tcanvas, graph, centerX, centerY, numWedges, wedgeGroups, wedges, legendGroup;","","\t// Arc Generator:","\tvar arc = d3.svg.arc()","\t\t.innerRadius( 0 )","\t\t.outerRadius( function(d,i) { return radiusScale( d.radius ); } )","\t\t.startAngle( function(d,i) { return angleScale( d.angle ); } );","","\tfunction chart( selection ) {","","\t\tselection.each( function( data ) {","","\t\t\t// Determine the number of wedges:","\t\t\tnumWedges = data.length;","","\t\t\t// Standardize the data:","\t\t\tdata = formatData( data );","","\t\t\t// Update the chart parameters:","\t\t\tupdateParams();","","\t\t\t// Create the chart base:","\t\t\tcreateBase( this );","","\t\t\t// Create the wedges:","\t\t\tcreateWedges( data );","","\t\t});","","\t}; // end FUNCTION chart()","","\t//","\tfunction formatData( data ) {","\t\t// Convert data to standard representation; needed for non-deterministic accessors:","\t\tdata = data.map( function(d, i) {","\t\t\treturn {","\t\t\t\t'angle': angle.call(data, d, i),","\t\t\t\t'area': area.call(data, d, i),","\t\t\t\t'label': label.call(data, d, i)\t\t\t","\t\t\t};","\t\t});","","\t\t// Now convert the area values to radii:","\t\t// http://understandinguncertainty.org/node/214 ","\t\treturn data.map( function(d, i) {","\t\t\treturn {","\t\t\t\t'angle': d.angle,","\t\t\t\t'label': d.label,","\t\t\t\t'radius': d.area.map( function(area) {","\t\t\t\t\treturn Math.sqrt( area*numWedges / Math.PI );","\t\t\t\t})","\t\t\t}","\t\t})","\t}; // end FUNCTION formatData()","","\t//","\tfunction updateParams() {","\t\t// Update the arc generator:","\t\tarc.endAngle( function(d,i) { return angleScale( d.angle ) + (Math.PI / (numWedges/2)); } );","","\t\t// Determine the chart center:","\t\tcenterX = (width - margin.left - margin.right) / 2;","\t\tcenterY = (height - margin.top - margin.bottom) / 2;","","\t\t// Update the radius scale:","\t\tradiusScale.domain( domain )","\t\t\t.range( [0, d3.min( [centerX, centerY] ) ] );","","\t\t// Update the angle scale:","\t\tangleScale.domain( [0, numWedges] );\t\t","\t}; // end FUNCTION updateParams()","","\t// ","\tfunction createBase( selection ) {","","\t\t// Create the SVG element:","\t\tcanvas = d3.select( selection ).append('svg:svg')","\t\t\t.attr('width', width)","\t\t\t.attr('height', height)","\t\t\t.attr('class', 'canvas');","","\t\t// Create the graph element:","\t\tgraph = canvas.append('svg:g')","\t\t\t.attr('class', 'graph')","\t\t\t.attr('transform', 'translate(' + (centerX + margin.left) + ',' + (centerY + margin.top) + ')');","","\t}; // end FUNCTION createBase()","","","\tfunction createWedges( data ) {","","\t\t// Create the wedge groups:","\t\twedgeGroups = graph.selectAll('.wedgeGroup')","\t\t\t.data( data )","\t\t  .enter().append('svg:g')","\t\t  \t.attr('class', 'wedgeGroup')","\t\t  \t.attr('transform', 'scale(0,0)');","","\t\t// Create the wedges:","\t\twedges = wedgeGroups.selectAll('.wedge')","\t\t  \t.data( function(d) { ","\t\t  \t\tvar ids = d3.range(0, legend.length);","","\t\t  \t\tids.sort( function(a,b) { ","\t\t\t  \t\tvar val2 = d.radius[b],","\t\t\t  \t\t\tval1 = d.radius[a]","\t\t\t  \t\treturn  val2 - val1; ","\t\t\t  \t});","\t\t\t  \treturn ids.map( function(i) {","\t\t\t  \t\treturn {","\t\t\t  \t\t\t'legend': legend[i],","\t\t\t  \t\t\t'radius': d.radius[i],","\t\t\t  \t\t\t'angle': d.angle","\t\t\t  \t\t};","\t\t\t  \t});","\t\t  \t})","\t\t  .enter().append('svg:path')","\t\t  \t.attr('class', function(d) { return 'wedge ' + d.legend; })","\t\t  \t.attr('d', arc );","","\t\t// Append title tooltips:","\t\twedges.append('svg:title')","\t\t\t.text( function(d) { return d.legend + ': ' + Math.floor(Math.pow(d.radius,2) * Math.PI / numWedges); });","","\t\t// Transition the wedges to view:","\t\twedgeGroups.transition()","\t\t\t.delay( delay )","\t\t\t.duration( function(d,i) { ","\t\t\t\treturn duration*i;","\t\t\t})","\t\t\t.attr('transform', 'scale(1,1)');","","\t\t// Append labels to the wedgeGroups:","\t\tvar numLabels = d3.selectAll('.label-path')[0].length;","\t\t","\t\twedgeGroups.selectAll('.label-path')","\t\t\t.data( function(d,i) { ","\t\t\t\treturn [","\t\t\t\t\t{","\t\t\t\t\t\t'index': i,","\t\t\t\t\t\t'angle': d.angle,","\t\t\t\t\t\t'radius': d3.max( d.radius.concat( [23] ) )","\t\t\t\t\t}","\t\t\t\t];","\t\t\t} )","\t\t  .enter().append('svg:path')","\t\t  \t.attr('class', 'label-path')","\t\t  \t.attr('id', function(d) {","\t\t  \t\treturn 'label-path' + (d.index + numLabels);","\t\t  \t})","\t\t\t.attr('d', arc)","\t\t  \t.attr('fill', 'none')","\t\t  \t.attr('stroke', 'none');","","\t\twedgeGroups.selectAll('.label')","\t\t\t.data( function(d,i) { ","\t\t\t\treturn [","\t\t\t\t\t{","\t\t\t\t\t\t'index': i,","\t\t\t\t\t\t'label': d.label","\t\t\t\t\t}","\t\t\t\t];","\t\t\t} )","\t\t  .enter().append('svg:text')","\t   \t\t.attr('class', 'label')","\t   \t\t.attr('text-anchor', 'start')","\t   \t\t.attr('x', 5)","\t   \t\t.attr('dy', '-.71em')","\t   \t\t.attr('text-align', 'center')","\t  \t\t.append('textPath')","\t  \t\t\t.attr('xlink:href', function(d,i) { ","\t  \t\t\t\treturn '#label-path' + (d.index + numLabels);","\t  \t\t\t})","\t  \t\t\t.text( function(d) { return d.label; } );","","\t}; // end FUNCTION createWedges()\t","","\t// Set/Get: margin","\tchart.margin = function( _ ) {","\t\tif (!arguments.length) return margin;","\t\tmargin = _;","\t\treturn chart;","\t};","","\t// Set/Get: width","\tchart.width = function( _ ) {","\t\tif (!arguments.length) return width;","\t\twidth = _;","\t\treturn chart;","\t};","","\t// Set/Get: height","\tchart.height = function( _ ) {","\t\tif (!arguments.length) return height;","\t\theight = _;","\t\treturn chart;","\t};","","\t// Set/Get: area","\tchart.area = function( _ ) {","\t\tif (!arguments.length) return area;","\t\tarea = _;","\t\treturn chart;","\t};","","\t// Set/Get: angle","\tchart.angle = function( _ ) {","\t\tif (!arguments.length) return angle;","\t\tangle = _;","\t\treturn chart;","\t};","","\t// Set/Get: label","\tchart.label = function( _ ) {","\t\tif (!arguments.length) return label;","\t\tlabel = _;","\t\treturn chart;","\t};","","\t// Set/Get: domain","\tchart.domain = function( _ ) {","\t\tif (!arguments.length) return domain;","\t\tdomain = _;","\t\treturn chart;","\t};","","\t// Set/Get: legend","\tchart.legend = function( _ ) {","\t\tif (!arguments.length) return legend;","\t\tlegend = _;","\t\treturn chart;","\t};","","\t// Set/Get: delay","\tchart.delay = function( _ ) {","\t\tif (!arguments.length) return delay;","\t\tdelay = _;","\t\treturn chart;","\t};","","\t// Set/Get: duration","\tchart.duration = function( _ ) {","\t\tif (!arguments.length) return duration;","\t\tduration = _;","\t\treturn chart;","\t};","","\treturn chart;","","}; // end FUNCTION rose()","","","","","","Chart.legend = function( entries ) {","\t// NOTE: positioning handled by CSS.","","\t// Add a legend:","\tvar legend = {}, ","\t\theight,","\t\tsymbolRadius = 5;","","\tlegend.container = d3.select('body').append('div')","\t\t.attr('class', 'legend');","","\theight = parseInt( d3.select('.legend').style('height'), 10);","\tlegend.canvas = legend.container.append('svg:svg')","\t\t\t.attr('class', 'legend-canvas');","","\tlegend.entries = legend.canvas.selectAll('.legend-entry')","\t\t.data( entries )","\t  .enter().append('svg:g')","\t  \t.attr('class', 'legend-entry')","\t  \t.attr('transform', function(d,i) { return 'translate('+ (symbolRadius + i*120) +', ' + (height/2) + ')'; });","","\t// Append circles to each entry with appropriate class:","\tlegend.entries.append('svg:circle')","\t\t.attr('class', function(d) { return 'legend-symbol ' + d;} )","\t\t.attr('r', symbolRadius )","\t\t.attr('cy', 0 )","\t\t.attr('cx', 0 );","","\t// Append text to each entry:","\tlegend.entries.append('svg:text')","\t\t.attr('class', 'legend-text' )","\t\t.attr('text-anchor', 'start')","\t\t.attr('dy', '.35em')","\t\t.attr('transform', 'translate(' + (symbolRadius*2) + ',0)')","\t\t.text( function(d) { return d; } );","","\t// Add interactivity:","\tlegend.entries.on('mouseover.focus', mouseover)","\t\t.on('mouseout.focus', mouseout);","","\t//","\tfunction mouseover() {","","\t\t// Select the current element and get the symbol child class:","\t\tvar _class = d3.select( this ).select('.legend-symbol')","\t\t\t.attr('class')","\t\t\t.replace('legend-symbol ', ''); // left with legend class.","","\t\td3.selectAll('.wedge')","\t\t\t.filter( function(d,i) {","\t\t\t\t// Select those elements not belonging to the same symbol class:","\t\t\t\treturn !d3.select( this ).classed( _class );","\t\t\t})","\t\t\t.transition()","\t\t\t\t.duration( 1000 )","\t\t\t\t.attr('opacity', 0.05 );","","\t}; // end FUNCTION mouseover()","","\tfunction mouseout() {","","\t\td3.selectAll('.wedge')","\t\t\t.transition()","\t\t\t\t.duration( 500 )","\t\t\t\t.attr('opacity', 1 );","","\t}; // end FUNCTION mouseout()","","}; // end FUNCTION legend()","","","Chart.slider = function( minVal, maxVal, step ) {","","\td3.select('body').append('input')","\t\t.attr('class', 'slider')","\t\t.attr('type', 'range')","\t\t.attr('name', 'slider')","\t\t.attr('min', minVal)","\t\t.attr('max', maxVal)","\t\t.attr('step', 0.001)","\t\t.attr('value', maxVal);","","\td3.select(\"input\").on(\"change\", function() {","\t  var value = Math.round(this.value);","","\t  d3.selectAll('.wedgeGroup')","\t  \t.filter( function(d,i) { return i < value; } )","\t  \t.transition()","\t  \t\t.duration( 500 )","\t  \t\t.attr( 'transform', 'scale(1,1)');","\t  ","\t  d3.selectAll('.wedgeGroup')","\t  \t.filter( function(d,i) { return i >= value; } )","\t  \t.transition()","\t  \t\t.duration( 500 )","\t  \t\t.attr( 'transform', 'scale(0,0)' );","","\t});","","","}; // end FUNCTION slider()","","","style.css#","","","/* Apply a natural box layout model to all elements */","* { ","\t-moz-box-sizing: border-box;","\t-webkit-box-sizing: border-box;","\tbox-sizing: border-box; ","}","","body {","\tfont-family: 'Cabin', sans-serif;","\tfont-size: 14px;","\tfont-weight: normal;","\tcolor: #474747;","\twidth: 100%;","\tmin-height: 100%;","}","","figure {","\tposition: relative;","\tfloat: right;","\twidth: 50%;","\tmin-width: 400px;","\tmargin-top: -120px;","}","","h1 {","\twidth: 70%;","\tmargin: 0 auto;","\tmargin-top: 20px;","\tmargin-bottom: 20px;","\ttext-align: center;","\tfont-size: 24px;","}","",".title, .subtitle, .caption, .label, .legend, figure {","\tfont-family: baskerville, serif;","}","",".title, .subtitle, .label, .legend {","\ttext-transform: uppercase;","}","",".title {","\tfont-size: 18px;","\twidth: 400px;","\ttext-align: center;","\tdisplay: block;","\tmargin: 0 auto;","\tmargin-top: 50px;","}","","\t.title .small {","\t\tfont-size: 12px;","\t}","",".subtitle {","\tfont-size: 16px;","\twidth: 50%;","\tmin-width: 400px;","\tmargin-top: 16px;","\ttext-align: center;","}","","\t.subtitle.left {","\t\tfloat: left;","\t}","","\t.subtitle.right {","\t\tfloat: right;","\t}","","",".caption {","\tposition: relative;","\ttop: -170px;","\twidth: 320px;","\tdisplay: block;","\tmargin: 0 auto;","\tfont-style: oblique;","\tfont-size: 12px;","}","","\t.caption p {","\t\tmargin: 0;","\t\ttext-indent: 12px;","\t}","",".canvas {","\tfont-family: 'Cabin', sans-serif;"," \tfont-size: 14px;"," \tfill: #474747;"," \tfont-weight: normal;","}","",".wedge {","\tstroke: #aaa;","\tstroke-width: 1px;","\t/*shape-rendering: crispEdges;*/","}","",".label {","\tfont-size: 8px;","}","",".disease {","\tfill: rgb(198, 226, 255);","}","",".other {","\tfill: rgb(50,50,50);","}","",".wounds {","\tfill: rgb(252,112,147);","}","",".legend {","\twidth: 400px;","\theight: 50px;","\tpadding: 0 20px;","\tdisplay: block;","\tposition: relative;","\tmargin: 0 auto;","\ttop: -150px;","\ttext-align: center;","}","",".slider {","\twidth: 400px;","\tdisplay: block;","\tposition: relative;","\tmargin: 0 auto;","\tleft: -30px; /* hacky */","\ttop: -100px;","}"],"id":2}]]},"ace":{"folds":[],"scrolltop":2174,"scrollleft":0,"selection":{"start":{"row":127,"column":0},"end":{"row":127,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":113,"state":"js-no_regex","mode":"ace/mode/html"}},"timestamp":1638748049752}